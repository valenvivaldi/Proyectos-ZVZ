<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Plato - models/game-test.js</title>

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="">
  <meta name="author" content="">

  <!--[if lt IE 9]>
  <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
  <![endif]-->

  <link href="../../assets/css/vendor/morris.css" rel="stylesheet">
  <link href="../../assets/css/vendor/bootstrap.css" rel="stylesheet">
  <link href="../../assets/css/vendor/font-awesome.css" rel="stylesheet">
  <link href="../../assets/css/vendor/codemirror.css" rel="stylesheet">
  <link href="../../assets/css/plato.css" rel="stylesheet">
  <link href="../../assets/css/plato-file.css" rel="stylesheet">

</head>

<body>

<div class="navbar navbar-fixed-top">
  <div class="container">
    <a class="navbar-brand" href="http://github.com/es-analysis/plato">Plato on Github</a>
    <ul class="nav navbar-nav">
      <li>
        <a href="../../index.html">Report Home</a>
      </li>
    </ul>
  </div>
</div>

<div class="jumbotron">
  <div class="container">
    <h1>models/game-test.js</h1>
  </div>
</div>

<div class="container aggregate-stats">
  <div class="row">
    <div class="col-md-6">
      <h2 class="header">Maintainability <a href="http://blogs.msdn.com/b/codeanalysis/archive/2007/11/20/maintainability-index-range-and-meaning.aspx"><i class="icon icon-info-sign" rel="popover" data-placement="top" data-trigger="hover" data-content="A value between 0 and 100 that represents the relative ease of maintaining the code. A high value means better maintainability." data-original-title="Maintainability Index"  data-container="body"></i></a></h2>
      <p class="stat">68.45</p>
    </div>
    <div class="col-md-6">
      <h2 class="header">Lines of code <i class="icon icon-info-sign" rel="popover" data-placement="top" data-trigger="hover" data-content="Source Lines of Code / Logical Lines of Code" data-original-title="SLOC/LSLOC" data-container="body"></i></h2>
      <p class="stat">326</p>
    </div>
  </div>
  <div class="row historical">
    <div class="col-md-6">
      <p id="chart_historical_maint" class="chart"></p>
    </div>
    <div class="col-md-6">
      <p id="chart_historical_sloc" class="chart"></p>
    </div>
  </div>
  <div class="row">
    <div class="col-md-6">
      <h2 class="header">Difficulty  <a href="http://en.wikipedia.org/wiki/Halstead_complexity_measures"><i class="icon icon-info-sign" rel="popover" data-placement="top" data-trigger="hover" data-content="The difficulty measure is related to the difficulty of the program to write or understand." data-original-title="Difficulty" data-container="body"></i></a></h2>
      <p class="stat">12.46</p>
    </div>
    <div class="col-md-6">
      <h2 class="header">Estimated Errors  <a href="http://en.wikipedia.org/wiki/Halstead_complexity_measures"><i class="icon icon-info-sign" rel="popover" data-placement="top" data-trigger="hover" data-content="Halstead's delivered bugs is an estimate for the number of errors in the implementation." data-original-title="Delivered Bugs" data-container="body"></i></a></h2>
      <p class="stat">0.59</p>
    </div>
  </div>
</div>

<div class="container charts">
  <div class="row">
    <h2 class="header">Function weight</h2>
  </div>
  <div class="row">
    <div class="col-md-6">
      <h3 class="chart-header">By Complexity <a href="http://en.wikipedia.org/wiki/Cyclomatic_complexity"><i class="icon icon-info-sign" rel="popover" data-placement="top" data-trigger="hover" data-content="This metric counts the number of distinct paths through a block of code. Lower values are better." data-original-title="Cyclomatic Complexity" data-container="body"></i></a></h3>
      <div id="fn-by-complexity" class="stat"></div>
    </div>
    <div class="col-md-6">
      <h3 class="chart-header">By SLOC  <i class="icon icon-info-sign" rel="popover" data-placement="top" data-trigger="hover" data-content="Source Lines of Code / Logical Lines of Code" data-original-title="SLOC/LSLOC" data-container="body"></i></h3>
      <div id="fn-by-sloc" class="stat"></div>
    </div>
  </div>
</div>

<div class="container">
  <div class="row">
    <textarea id="file-source" class="col-md-12">var expect = require(&quot;chai&quot;).expect;
var gameModel = require(&quot;../models/game.js&quot;);

var Game = gameModel.game;

var playerModel = require(&quot;../models/player.js&quot;);
var Player = playerModel.player;

var cardModel = require(&quot;../models/card.js&quot;);
var Card = cardModel.card;

describe(&#039;Game&#039;,function(){
	it(&#039;should have two players&#039;, function(done){
    //console.log(&quot;PLAYER !!&quot;);
    //console.log(p1);
    
    /*var pla1;
    var pla2;
    p1.save(function (err,player1){
      console.log(&quot;player1 hola&quot;);
      if(err){
        console.log(err);
        done(err)
      }
      pla1=player1;
      //expect(game.player1).to.be.eq(data.player1);
      // expect(game.player2).to.be.eq(data.player2);
      //done();
    });
    p2.save(function (err,player2){
      console.log(&quot;player2 hola&quot;);
      if(err){
        console.log(err);
        done(err)
      }
      pla2=player2;
      //expect(game.player1).to.be.eq(data.player1);
      // expect(game.player2).to.be.eq(data.player2);
      //done();
    });
    console.log(&quot;pla1&quot;);
    console.log(pla1);*/

    var cartasp1 = [new Card(7,&#039;basto&#039;),new Card(12,&#039;oro&#039;),new Card(3,&#039;basto&#039;)];
    var cartasp2 = [new Card(1,&#039;basto&#039;),new Card(1,&#039;espada&#039;),new Card(7,&#039;espada&#039;)];
    var p1 = new Player({name: &quot;Leo&quot;, password:&quot;1234&quot;, cards: cartasp1 , envidoPoints: 30});
    var p2 = new Player({name: &quot;Bruno&quot;, password:&quot;5678&quot;, cards: cartasp2 , envidoPoints: 28});
    
    p1.save(function (err,player1){
      //console.log(&quot;player1 hola&quot;);
      if(err){
        console.log(err);
        done(err)
      }
      //pla1=player1;
      //expect(game.player1).to.be.eq(data.player1);
      // expect(game.player2).to.be.eq(data.player2);
      //done();
      p2.save(function (err,player2){
        //console.log(&quot;player2 hola&quot;);
        if(err){
          console.log(err);
          done(err)
        }
        //pla2=player2;
        //expect(game.player1).to.be.eq(data.player1);
        // expect(game.player2).to.be.eq(data.player2);
        //done();
        var data = {
          
          player1: player1,
          player2: player2,
          rounds : [],
          currentHand: player2,
          currentRound : undefined,
          score : [0,0]
        }
        //console.log(&quot;DATA !!&quot;);
        //console.log(data);
        var g = new Game(data);
        //console.log(&quot;Game !!&quot;);
        //console.log(g);
        g.save(function (err, game) {
          //console.log(&quot;Game hola&quot;);
          if(err){
            console.log(err);
            done(err)
          }
          console.log(game.toString());
          Game.findOne({player2:player2._id},function(err,result){
            console.log(result);
            if (err) {
              console.log(&quot;err&quot;);
              console.log(err);
              done(err);
            }
            Player.findOne({_id:result.player2}, function(err,result2){
              console.log(result2.name);
              expect(result2.name).to.be.eq(&#039;Bruno&#039;);
              done();
            });
            //expect(result.player2.name).to.be.eq(&#039;Leoa&#039;);
          });
          //expect(game.player1.name).to.be.eq(data.player1.name);
          //expect(game.player2.name).to.be.eq(data.player2.name);
          //done();
        });
      });
    });
	});
	
	/*it(&#039;should have player 2&#039;, function(){
		var p1 = new Player(&#039;Pedro&#039;);
		var p2 = new Player(&#039;Juan&#039;);
		var g = new Game(p1,p2);
		expect(g).to.have.property(&#039;player2&#039;);
	});

	it(&#039;should change turn&#039;, function(){
		var game = new Game();
		game.newRound();
		expect(game.currentHand).to.be.equal(game.player1);
		game.currentHand = game.switchPlayer(game.currentHand);
		expect(game.currentHand).to.be.equal(game.player2);
		game.currentHand = game.switchPlayer(game.currentHand);
		expect(game.currentHand).to.be.equal(game.player1);
	});*/
});

/*describe(&#039;Game play (1)&#039;, function(){
  var game;

  beforeEach(function(){
    game = new Game();
    game.newRound();

    c1=new Card(1, &#039;copa&#039;);
    c2=new Card(7, &#039;oro&#039;);
    c3=new Card(2, &#039;oro&#039;);
    game.player1.cards=[c1,c2,c3];
    game.player1.pointsenv=game.player1.getPoints();

    c1=new Card(6, &#039;copa&#039;),
    c2=new Card(7, &#039;copa&#039;),
    c3=new Card(2, &#039;basto&#039;)
    game.player2.cards=[c1,c2,c3];
    game.player2.pointsenv=game.player2.getPoints();


  });

  it(&#039;plays [envido, quiero] should gives 2 points to winner&#039;, function(){
    game.play(game.player1, &#039;envido&#039;);
    game.play(game.player2, &#039;quiero&#039;);
    expect(game.score).to.deep.equal([0, 2]);
  });

  it(&#039;plays [envido, no quiero] should gives 1 points to player1&#039;, function(){
  	game.play(game.player1, &#039;envido&#039;);
  	game.play(game.player2, &#039;no-quiero&#039;);
  	expect(game.score).to.deep.equal([1, 0]);
  });

  it(&#039;plays [truco, no quiero] should gives 2 points to player1&#039;, function(){
    game.play(game.player1, &#039;truco&#039;);
    game.play(game.player2, &#039;no-quiero&#039;);
   	expect(game.score).to.deep.equal([1, 0]);
  });

  it(&#039;jugando con las cartas&#039;, function(){
    game.play(game.player1, &#039;play card&#039;, game.player1.jugarCarta(0));
    game.play(game.player2, &#039;play card&#039;, game.player2.jugarCarta(0));
    game.play(game.player1, &#039;play card&#039;, game.player1.jugarCarta(1));
    game.play(game.player2, &#039;play card&#039;, game.player2.jugarCarta(1));
   expect(game.score).to.deep.equal([1, 0]);
  });

  it(&#039;jugando con las cartas (con funcion jugarCarta)&#039;, function(){
    game.play(game.player1, &#039;play card&#039;, game.player1.jugarCarta(0));
    game.play(game.player2, &#039;play card&#039;, game.player2.jugarCarta(0));
    game.play(game.player1, &#039;play card&#039;, game.player1.jugarCarta(1));
    game.play(game.player2, &#039;play card&#039;, game.player2.jugarCarta(1));
   expect(game.score).to.deep.equal([1, 0]);
  });

  it(&#039;jugando con las cartas y truco&#039;, function(){
    game.play(game.player1, &#039;play card&#039;, game.player1.jugarCarta(0));
    game.play(game.player2, &#039;play card&#039;, game.player2.jugarCarta(2));
    game.play(game.player2, &#039;play card&#039;, game.player2.jugarCarta(1));
    game.play(game.player1, &#039;play card&#039;, game.player1.jugarCarta(1));
    game.play(game.player1, &#039;truco&#039;);
    game.play(game.player2, &#039;quiero&#039;);
    game.play(game.player1, &#039;play card&#039;, game.player1.jugarCarta(2));
    game.play(game.player2, &#039;play card&#039;, game.player2.jugarCarta(0));
   expect(game.score).to.deep.equal([2, 0]);
  });

});

describe(&#039;Game play (2)&#039;, function(){
  var game;

  beforeEach(function(){
    game = new Game();
    game.newRound();

    c1=new Card(1, &#039;copa&#039;);
    c2=new Card(7, &#039;oro&#039;);
    c3=new Card(2, &#039;espada&#039;);
    game.player1.cards=[c1,c2,c3];
    game.player1.pointsenv=game.player1.getPoints();

    c1=new Card(3, &#039;oro&#039;),
    c2=new Card(7, &#039;copa&#039;),
    c3=new Card(2, &#039;basto&#039;)
    game.player2.cards=[c1,c2,c3];
    game.player2.pointsenv=game.player2.getPoints();


  });

  it(&#039;jugando las cartas, 1er mano gana player2, 2da gana player1, player 2 canta truco, player 1 acepta, 3er mano empate; deberia darles los puntos del truco a player 2&#039;, function(){
    	game.play(game.player1, &#039;play card&#039;, game.player1.jugarCarta(0));
    	game.play(game.player2, &#039;play card&#039;, game.player2.jugarCarta(0));
	    game.play(game.player2, &#039;play card&#039;, game.player2.jugarCarta(1));
    	game.play(game.player1, &#039;play card&#039;, game.player1.jugarCarta(1));
	    game.play(game.player1, &#039;truco&#039;);
    	game.play(game.player2, &#039;quiero&#039;);
	    game.play(game.player1, &#039;play card&#039;, game.player1.jugarCarta(2));
    	game.play(game.player2, &#039;play card&#039;, game.player2.jugarCarta(2));
    expect(game.score).to.deep.equal([0, 2]);
  });
   it(&#039;jugando las cartas, 1er mano gana player1, 2da gana player2, player 2 canta truco, player 1 acepta, 3er mano empate; deberia darles los puntos del truco a player 1&#039;, function(){
	    game.play(game.player1, &#039;play card&#039;, game.player1.jugarCarta(1));
	    game.play(game.player2, &#039;play card&#039;, game.player2.jugarCarta(1));
	    game.play(game.player1, &#039;play card&#039;, game.player1.jugarCarta(0));
	    game.play(game.player2, &#039;play card&#039;, game.player2.jugarCarta(0));
	    game.play(game.player2, &#039;truco&#039;);
	    game.play(game.player1, &#039;quiero&#039;);
	    game.play(game.player2, &#039;play card&#039;, game.player2.jugarCarta(2));
	    game.play(game.player1, &#039;play card&#039;, game.player1.jugarCarta(2));
    expect(game.score).to.deep.equal([2, 0]);
  });
	it(&#039;jugando las cartas, 1er mano gana player2,player2 canta envido,player1 no quiere, 2da gana player1, player 2 canta truco, player 1 acepta, 3er mano empate; deberia darles los puntos del truco a mas un punto del envido a player2&#039;, function(){
		game.play(game.player1, &#039;play card&#039;, game.player1.jugarCarta(0));
		game.play(game.player2, &#039;envido&#039;);
		game.play(game.player1, &#039;no-quiero&#039;);
		game.play(game.player2, &#039;play card&#039;, game.player2.jugarCarta(0));
		game.play(game.player2, &#039;play card&#039;, game.player2.jugarCarta(1));
		game.play(game.player1, &#039;play card&#039;, game.player1.jugarCarta(1));
		game.play(game.player1, &#039;truco&#039;);
		game.play(game.player2, &#039;quiero&#039;);
		game.play(game.player1, &#039;play card&#039;, game.player1.jugarCarta(2));
		game.play(game.player2, &#039;play card&#039;, game.player2.jugarCarta(2));
  	expect(game.score).to.deep.equal([0, 3]);
  });
	it(&#039;jugando las cartas, 1er mano gana player2,player2 canta envido,player1 quiere, 2da gana player1, player 2 canta truco, player 1 acepta, 3er mano empate; deberia darles los puntos del truco a player 2 y los puntos del envido a player1&#039;, function(){
	    game.play(game.player1, &#039;play card&#039;, game.player1.jugarCarta(0));
		game.play(game.player2, &#039;envido&#039;);
		game.play(game.player1, &#039;quiero&#039;);
		game.play(game.player2, &#039;play card&#039;, game.player2.jugarCarta(0));
	    game.play(game.player2, &#039;play card&#039;, game.player2.jugarCarta(1));
	    game.play(game.player1, &#039;play card&#039;, game.player1.jugarCarta(1));
	    game.play(game.player1, &#039;truco&#039;);
	    game.play(game.player2, &#039;quiero&#039;);
	    game.play(game.player1, &#039;play card&#039;, game.player1.jugarCarta(2));
	    game.play(game.player2, &#039;play card&#039;, game.player2.jugarCarta(2));
    expect(game.score).to.deep.equal([2, 2]);
  });
});

describe(&#039;Game play (2)&#039;, function(){
  var game;

  beforeEach(function(){
    game = new Game();
  });

  it(&#039;jugando dos rondas, primera ronda dos puntos para player2, segunda ronda 4 puntos player1&#039;, function(){
    game.newRound();


    c1=new Card(1, &#039;copa&#039;);
    c2=new Card(7, &#039;oro&#039;);
    c3=new Card(2, &#039;espada&#039;);
    game.player1.cards=[c1,c2,c3];
    game.player1.pointsenv=game.player1.getPoints();

    c1=new Card(3, &#039;oro&#039;);
    c2=new Card(7, &#039;copa&#039;);
    c3=new Card(2, &#039;basto&#039;);
    game.player2.cards=[c1,c2,c3];
    game.player2.pointsenv=game.player2.getPoints();   
    game.play(game.player1, &#039;play card&#039;, game.player1.jugarCarta(0));
    game.play(game.player2, &#039;play card&#039;, game.player2.jugarCarta(0));
    game.play(game.player2, &#039;play card&#039;, game.player2.jugarCarta(1));
    game.play(game.player1, &#039;play card&#039;, game.player1.jugarCarta(1));
    game.play(game.player1, &#039;truco&#039;);
    game.play(game.player2, &#039;quiero&#039;);
    game.play(game.player1, &#039;play card&#039;, game.player1.jugarCarta(2));
    game.play(game.player2, &#039;play card&#039;, game.player2.jugarCarta(2));
    game.newRound();
    c1=new Card(1, &#039;espada&#039;);
    c2=new Card(7, &#039;oro&#039;);
    c3=new Card(6, &#039;oro&#039;);
    game.player1.cards=[c1,c2,c3];
    game.player1.pointsenv=game.player1.getPoints();

    c1=new Card(3, &#039;oro&#039;);
    c2=new Card(7, &#039;copa&#039;);
    c3=new Card(2, &#039;copa&#039;);
    game.player2.cards=[c1,c2,c3];
    game.player2.pointsenv=game.player2.getPoints();

    game.play(game.player2, &#039;play card&#039;, game.player2.jugarCarta(0));
	game.play(game.player1, &#039;envido&#039;);
	game.play(game.player2, &#039;quiero&#039;);
	game.play(game.player1, &#039;play card&#039;, game.player1.jugarCarta(0));
	game.play(game.player1, &#039;truco&#039;);
    game.play(game.player2, &#039;quiero&#039;);
    game.play(game.player1, &#039;play card&#039;, game.player1.jugarCarta(1));
    game.play(game.player2, &#039;play card&#039;, game.player2.jugarCarta(1));

  expect(game.score).to.deep.equal([4, 2]);
  });
});*/</textarea>
  </div>
</div>

<footer class="footer">
  <div class="container">
    <p>.</p>
  </div>
</footer>

<script type="text/html" id="complexity-popover-template">
  <div class="complexity-notice">
    Complexity : {{ cyclomatic }} <br>
    Length : {{ halstead.length }} <br>
    Difficulty : {{ halstead.difficulty.toFixed(2) }} <br>
    Est # bugs : {{ halstead.bugs.toFixed(2) }}<br>
  </div>
</script>

<script type="text/javascript" src="../../assets/scripts/bundles/core-bundle.js"></script>
<script type="text/javascript" src="../../assets/scripts/bundles/codemirror.js"></script>
<script type="text/javascript" src="../../assets/scripts/codemirror.markpopovertext.js"></script>
<script type="text/javascript" src="report.js"></script>
<script type="text/javascript" src="report.history.js"></script>
<script type="text/javascript" src="../../assets/scripts/plato-file.js"></script>
</body>
</html>
